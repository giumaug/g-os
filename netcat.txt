netcat

nc -l 127.0.0.1 4444
nc 127.0.0.1 4444
tcpdump  port 4444 -U -XX -vv -e -nn  -i lo





0x0000:  0000 0000 0000 0000 0000 0000 0800 4500  ..............E.
0x0010:  003e af7b 4000 4011 8d31 7f00 0001 7f00  .>.{@.@..1......
0x0020:  0001 c520 115c 002a fe3d 5468 6973 2069  .....\.*.=This.i
0x0030:  7320 6120 6661 6b65 2075 6470 2070 6163  s.a.fake.udp.pac
0x0040:  6b65 7421 2121 2121 2121 210a            ket!!!!!!!!.

eth
08 00 version
ip
45 version ip+header ip lenght
11 protocol type
8d31 checsum
7f00 0001 ip
udp
c520 source port
115c dest port
002a length
fe3d checksum
5468 start payload con This...



13:38:54.280964 IP (tos 0x0, ttl 64, id 46402, offset 0, flags [DF], proto UDP (17), length 62)
    172.16.6.100.49847 > localhost.localdomain.krb524: [udp sum ok] UDP, length 34
	0x0000:  0050 56c0 0008 000c 2910 64b3 0800 4500  .PV.....).d...E.
	0x0010:  003e b542 4000 4011 20e7 ac10 0664 ac10  .>.B@.@......d..
	0x0020:  0601 c2b7 115c 002a d806 5468 6973 2069  .....\.*..This.i
	0x0030:  7320 6120 6661 6b65 2075 6470 2070 6163  s.a.fake.udp.pac
	0x0040:  6b65 7421 2121 2121 2121 210a            ket!!!!!!!!.

45 00 00 3e 00 01 00 00 40 11 00 00 ac 10 06 64 ac 10 06 01 

4500+003e+0001+0000+4011+0+ac10+0664+ac10+0601 

1E9D5
 e9d6+1E9D5

ffff-d6e9=2916!!!!!!!!!!!!!!


verificare checksum qui
00000000  00 50 56 c0 00 08 00 0c 29 10 64 b3 08 00 45 00 .PV.....).d...E.
00000010  00 3e 00 01 00 00 40 11 29 16 ac 10 06 64 ac 10 .>....@.)....d..
00000020  06 01 d8 c4 27 0f 00 2a 59 6b 54 68 69 73 2e 69 ....'..*YkThis.i
00000030  73 2e 61 2e 66 61 6b 65 2e 75 64 70 2e 70 61 63 s.a.fake.udp.pac
00000040  6b 65 74 21 21 21 21 21 21                      ket!!!!!!

real header + 1 pad
d8c4+270f+0029+0000+5468+6973+2e69+732e+612e+6661+6b65+2e75+6470+2e70+6163+6b65+7421+2121+2121+2121+2100 =61903=1903+6=1909 !1909=e6f6

virtual header 
ac10+0664+ac10+0601+0011+0029 =164BF=64c0 !64c0=9b3f

checksum=1909+64c0=7dc9 !7dc9 = 8236

ip checksum
4500+003d+0001+0000+4011+162a+ac10+0664+ac10+0601
